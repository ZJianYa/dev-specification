# 分布式

## 背景

- 解决单机瓶颈
- 系统交互
- 避免单点故障
- 方便系统扩展，避免系统耦合

其他作用

负载均衡

## 实现

### 应用层

微服务，异地多活

### 数据库

水平拆分

### FAQ

* 开发
  * 事务管理  
  * 故障隔离
    * 应用独立部署，每个应用独享自己的数据库（如果需要数据交互，则可以通过 service interface 的方式）
    * 断路器，故障不可怕，可怕的是恢复时间和影响范围
* 运维
  * 部署
  * 故障排除和解决
  * 吞吐量/响应时间  
  * 需要监控，但是监控需要做的细致，有主次，信息过多和没有信息的价值基本上是一样的，不能让告警吓死/类似运维。  
  * 运维对线上系统的可控能力，以及控制的规范性、正确性，比如可以动态限流，可以计划内宕机，当然线上的控制最好是自动化的，但是有时候还是要保留人工干预的接口  
* 测试

* 分布式架构需要分布式团队，团队按照业务分，而不是按技能分
  在说的明白点，就是不能按照测试/运维/开发这么分，而是应该每个业务线都有自己的一套人马，自己的一套人马需要十分团结的去解决自己的问题。  
* 分布式需要团队紧密合作，而不能互相踢皮球，需要开发 hold all，自己的问题没有运维接手  
* 运维优先？亚马逊的运维人员NB的不行不行  

* 异构系统的不标准
  * 接口/协议/数据结构
    * 协议：程序的异常采用http的统一状态码。 业务异常如果是业务逻辑错误，那么应该在业务系统中可以监控，如果是devops来处理的，必然需要统一标准
    * 一致性：数据库连接数的一致性，keepalive的一致性  
  * 开发和运维方式
